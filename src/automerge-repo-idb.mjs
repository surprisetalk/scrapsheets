/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/@automerge/automerge-repo-storage-indexeddb@2.5.1/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
class e{database;store;dbPromise;constructor(e="automerge",r="documents"){this.database=e,this.store=r,this.dbPromise=this.createDatabasePromise()}createDatabasePromise(){return new Promise(((e,r)=>{const t=indexedDB.open(this.database,1);t.onerror=()=>{r(t.error)},t.onupgradeneeded=e=>{e.target.result.createObjectStore(this.store)},t.onsuccess=r=>{const t=r.target.result;e(t)}}))}async load(e){const r=(await this.dbPromise).transaction(this.store),t=r.objectStore(this.store).get(e);return new Promise(((e,o)=>{r.onerror=()=>{o(t.error)},t.onsuccess=r=>{const t=r.target.result;e(t&&"object"==typeof t&&"binary"in t?t.binary:void 0)}}))}async save(e,r){const t=(await this.dbPromise).transaction(this.store,"readwrite");return t.objectStore(this.store).put({key:e,binary:r},e),new Promise(((e,r)=>{t.onerror=()=>{r(t.error)},t.oncomplete=()=>{e()}}))}async remove(e){const r=(await this.dbPromise).transaction(this.store,"readwrite");return r.objectStore(this.store).delete(e),new Promise(((e,t)=>{r.onerror=()=>{t(r.error)},r.oncomplete=()=>{e()}}))}async loadRange(e){const r=await this.dbPromise,t=e,o=[...e,"￿"],s=IDBKeyRange.bound(t,o),n=r.transaction(this.store),a=n.objectStore(this.store).openCursor(s),i=[];return new Promise(((e,r)=>{n.onerror=()=>{r(a.error)},a.onsuccess=r=>{const t=r.target.result;t?(i.push({data:t.value.binary,key:t.key}),t.continue()):e(i)}}))}async removeRange(e){const r=await this.dbPromise,t=e,o=[...e,"￿"],s=IDBKeyRange.bound(t,o),n=r.transaction(this.store,"readwrite");return n.objectStore(this.store).delete(s),new Promise(((e,r)=>{n.onerror=()=>{r(n.error)},n.oncomplete=()=>{e()}}))}}export{e as IndexedDBStorageAdapter};export default null;
//# sourceMappingURL=/sm/91deda390b508e3a902f75195c5af1c7d3a32efe6dd0bbada4f28e13de57f4dc.map